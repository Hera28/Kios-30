<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kios 30</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

<style>
body{
  margin:0;
  font-family:system-ui,Segoe UI,Roboto;
  background:#f8fafc;
  color:#111827;
}
header{
  padding:20px;
  text-align:center;
  background:#16a34a;
  color:white;
}
.container{
  max-width:900px;
  margin:auto;
  padding:20px;
}
.card{
  background:white;
  padding:20px;
  border-radius:12px;
  margin-bottom:20px;
  box-shadow:0 6px 18px rgba(0,0,0,.08);
}
button{
  padding:12px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  background:#22c55e;
  color:white;
  font-size:1rem;
}
button.secondary{background:#64748b}
button.danger{background:#ef4444}
input,select{
  width:100%;
  padding:10px;
  margin:6px 0 12px;
  border-radius:6px;
  border:1px solid #d1d5db;
}
.grid{
  display:grid;
  gap:12px;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
}
.hidden{display:none}
.item{
  border:1px solid #e5e7eb;
  padding:12px;
  border-radius:10px;
}
footer{
  text-align:center;
  padding:20px;
  color:#6b7280;
}
</style>
</head>

<body>

<header>
  <h1 id="judul">üß∫ Kios 30</h1>
  <p>Toko Harian Keluarga</p>
</header>

<div class="container">

<div id="landing" class="card">
  <div class="grid">
    <button onclick="bukaPembeli()">üõí Pembeli</button>
    <button class="secondary" onclick="bukaAdmin()">üîê Admin</button>
  </div>
</div>

<div id="admin" class="card hidden">
  <h3>Kelola Barang</h3>

  <label>Nama Barang</label>
  <input id="nama">

  <label>Harga</label>
  <input id="harga" type="number">

  <label>Stok</label>
  <input id="stok" type="number">

  <label>Satuan</label>
  <select id="satuan">
    <option>kg</option>
    <option>pcs</option>
    <option>lusin</option>
    <option>dos</option>
  </select>

  <label>Kategori</label>
  <select id="kategori">
    <option>Sembako</option>
    <option>Sayur</option>
    <option>Buah</option>
    <option>Lainnya</option>
  </select>

  <button onclick="tambahBarang()">‚ûï Tambah Barang</button>

  <hr>

  <h4>Daftar Barang</h4>
  <div id="adminList"></div>

  <br>
  <button class="secondary" onclick="kembali()">‚¨Ö Kembali</button>
</div>

<div id="pembeli" class="card hidden">
  <h3>Daftar Barang</h3>
  <div id="listBarang" class="grid"></div>
  <br>
  <a id="waLink" target="_blank">üí¨ Pesan via WhatsApp</a>
  <br><br>
  <button class="secondary" onclick="kembali()">‚¨Ö Kembali</button>
</div>

</div>

<footer>‚ù§Ô∏è Kios Keluarga ‚ù§Ô∏è</footer>

<script>
// ================= FIREBASE =================
const firebaseConfig = {
  apiKey: "AIzaSyBCpRbMAIyfJzpzi5iC4xljFt_gyXaJ5Yw",
  authDomain: "kios-30.firebaseapp.com",
  projectId: "kios-30",
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// ================= VAR =================
const NO_WA = "62811897005";
let dataBarang = [];

// ================= NAV =================
function hideAll(){
  landing.classList.add("hidden");
  admin.classList.add("hidden");
  pembeli.classList.add("hidden");
}
function kembali(){
  hideAll();
  landing.classList.remove("hidden");
}
function bukaAdmin(){
  hideAll();
  admin.classList.remove("hidden");
  loadBarang();
}
function bukaPembeli(){
  hideAll();
  pembeli.classList.remove("hidden");
  loadBarang();
}

// ================= DATA =================
async function loadBarang(){
  try{
    const snap = await db.collection("barang").get();
    dataBarang = snap.docs.map(d => ({
      id:d.id,
      nama:d.data().nama || "",
      harga:d.data().harga || 0,
      stok:d.data().stok || 0,
      satuan:d.data().satuan || "",
      kategori:d.data().kategori || ""
    }));
    renderAdmin();
    renderPembeli();
  }catch(e){
    alert("Gagal load data");
    console.error(e);
  }
}

async function tambahBarang(){
  if(!nama.value) return alert("Nama kosong");
  await db.collection("barang").add({
    nama:nama.value,
    harga:Number(harga.value||0),
    stok:Number(stok.value||0),
    satuan:satuan.value,
    kategori:kategori.value
  });
  nama.value=harga.value=stok.value="";
  loadBarang();
}

// ================= RENDER =================
function renderAdmin(){
  adminList.innerHTML="";
  dataBarang.forEach(b=>{
    const d=document.createElement("div");
    d.className="item";
    d.innerHTML=`
      <strong>${b.nama}</strong><br>
      ${b.kategori} ‚Ä¢ ${b.stok} ${b.satuan}<br>
      Rp ${b.harga}
    `;
    adminList.appendChild(d);
  });
}

function renderPembeli(){
  listBarang.innerHTML="";
  dataBarang.forEach(b=>{
    const d=document.createElement("div");
    d.className="item";
    d.innerHTML=`
      <strong>${b.nama}</strong><br>
      ${b.stok} ${b.satuan}<br>
      Rp ${b.harga}
    `;
    listBarang.appendChild(d);
  });
  waLink.href=`https://wa.me/${NO_WA}`;
}
</script>

</body>
</html>
